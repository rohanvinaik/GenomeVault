from typing import Any, Dict

# mypy: allow-untyped-defs
import torch
from functorch.experimental.control_flow import cond


class CondClosedOverVariable(torch.nn.Module):
    """
    torch.cond() supports branches closed over arbitrary variables.
    """

    def forward(self, pred, x) -> None:
            """TODO: Add docstring for forward"""
    def true_fn(val) -> None:
                """TODO: Add docstring for true_fn"""
    return x * 2

        def false_fn(val) -> None:
                """TODO: Add docstring for false_fn"""
    return x - 2

        return cond(pred, true_fn, false_fn, [x + 1])

example_args = (torch.tensor(True), torch.randn(3, 2))
tags = {"torch.cond", "python.closure"}
model = CondClosedOverVariable()

