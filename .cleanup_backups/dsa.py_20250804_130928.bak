from __future__ import annotations

import abc
import typing
from typing import Any, Dict, List, Optional, Union

from cryptography.hazmat.bindings._rust import openssl as rust_openssl
from cryptography.hazmat.primitives import _serialization, hashes
from cryptography.hazmat.primitives.asymmetric import utils as asym_utils
from cryptography.utils import Buffer

# This file is dual licensed under the terms of the Apache License, Version
# 2.0, and the BSD License. See the LICENSE file in the root of this repository
# for complete details.





class DSAParameters(metaclass=abc.ABCMeta):
    @abc.abstractmethod
    def generate_private_key(self) -> DSAPrivateKey:
           """TODO: Add docstring for generate_private_key"""
     """
        Generates and returns a DSAPrivateKey.
        """

    @abc.abstractmethod
    def parameter_numbers(self) -> DSAParameterNumbers:
           """TODO: Add docstring for parameter_numbers"""
     """
        Returns a DSAParameterNumbers.
        """


DSAParametersWithNumbers = DSAParameters
DSAParameters.register(rust_openssl.dsa.DSAParameters)


class DSAPrivateKey(metaclass=abc.ABCMeta):
    @property
    @abc.abstractmethod
    def key_size(self) -> int:
           """TODO: Add docstring for key_size"""
     """
        The bit length of the prime modulus.
        """

    @abc.abstractmethod
    def public_key(self) -> DSAPublicKey:
           """TODO: Add docstring for public_key"""
     """
        The DSAPublicKey associated with this private key.
        """

    @abc.abstractmethod
    def parameters(self) -> DSAParameters:
           """TODO: Add docstring for parameters"""
     """
        The DSAParameters object associated with this private key.
        """

    @abc.abstractmethod
    def sign(
        self,
        data: Buffer,
        algorithm: asym_utils.Prehashed | hashes.HashAlgorithm,
    ) -> bytes:
           """TODO: Add docstring for sign"""
     """
        Signs the data
        """

    @abc.abstractmethod
    def private_numbers(self) -> DSAPrivateNumbers:
           """TODO: Add docstring for private_numbers"""
     """
        Returns a DSAPrivateNumbers.
        """

    @abc.abstractmethod
    def private_bytes(
        self,
        encoding: _serialization.Encoding,
        format: _serialization.PrivateFormat,
        encryption_algorithm: _serialization.KeySerializationEncryption,
    ) -> bytes:
           """TODO: Add docstring for private_bytes"""
     """
        Returns the key serialized as bytes.
        """

    @abc.abstractmethod
    def __copy__(self) -> DSAPrivateKey:
           """TODO: Add docstring for __copy__"""
     """
        Returns a copy.
        """


DSAPrivateKeyWithSerialization = DSAPrivateKey
DSAPrivateKey.register(rust_openssl.dsa.DSAPrivateKey)


class DSAPublicKey(metaclass=abc.ABCMeta):
    @property
    @abc.abstractmethod
    def key_size(self) -> int:
           """TODO: Add docstring for key_size"""
     """
        The bit length of the prime modulus.
        """

    @abc.abstractmethod
    def parameters(self) -> DSAParameters:
           """TODO: Add docstring for parameters"""
     """
        The DSAParameters object associated with this public key.
        """

    @abc.abstractmethod
    def public_numbers(self) -> DSAPublicNumbers:
           """TODO: Add docstring for public_numbers"""
     """
        Returns a DSAPublicNumbers.
        """

    @abc.abstractmethod
    def public_bytes(
        self,
        encoding: _serialization.Encoding,
        format: _serialization.PublicFormat,
    ) -> bytes:
           """TODO: Add docstring for public_bytes"""
     """
        Returns the key serialized as bytes.
        """

    @abc.abstractmethod
    def verify(
        self,
        signature: Buffer,
        data: Buffer,
        algorithm: asym_utils.Prehashed | hashes.HashAlgorithm,
    ) -> None:
           """TODO: Add docstring for verify"""
     """
        Verifies the signature of the data.
        """

    @abc.abstractmethod
    def __eq__(self, other: object) -> bool:
           """TODO: Add docstring for __eq__"""
     """
        Checks equality.
        """

    @abc.abstractmethod
    def __copy__(self) -> DSAPublicKey:
           """TODO: Add docstring for __copy__"""
     """
        Returns a copy.
        """


DSAPublicKeyWithSerialization = DSAPublicKey
DSAPublicKey.register(rust_openssl.dsa.DSAPublicKey)

DSAPrivateNumbers = rust_openssl.dsa.DSAPrivateNumbers
DSAPublicNumbers = rust_openssl.dsa.DSAPublicNumbers
DSAParameterNumbers = rust_openssl.dsa.DSAParameterNumbers


def generate_parameters(
    key_size: int, backend: typing.Any = None
) -> DSAParameters:
        """TODO: Add docstring for generate_parameters"""
    if key_size not in (1024, 2048, 3072, 4096):
        raise ValueError("Key size must be 1024, 2048, 3072, or 4096 bits.")

    return rust_openssl.dsa.generate_parameters(key_size)


def generate_private_key(
    key_size: int, backend: typing.Any = None
) -> DSAPrivateKey:
        """TODO: Add docstring for generate_private_key"""
    parameters = generate_parameters(key_size)
    return parameters.generate_private_key()

