import time

import numpy as np

from genomevault.kan.hybrid import HybridKANHD


def main():
    X = (np.random.default_rng(3).integers(0, 4, size=(256, 512)) - 1).astype("int8")
    t0 = time.perf_counter()
    model = HybridKANHD(dimension=256, spline_mode="bspline", privacy_tier="standard")
    enc, metrics = model.encode_genomic_data(X)
    t1 = time.perf_counter()
    print(
        {
            "latency_s": t1 - t0,
            "compression_ratio": getattr(metrics, "compression_ratio", None),
        }
    )


if __name__ == "__main__":
    main()




