from genomevault.observability.logging import configure_logging

logger = configure_logging()
#!/usr/bin/env python3
import argparse
from pathlib import Path

from genomevault.governance.pii.patterns import detect


def scan_file(path: Path):
    text = path.read_text(encoding="utf-8", errors="ignore")
    matches = detect(text)
    for m in matches:
        logger.info(f"{path}:{m.span[0]}-{m.span[1]}\t{m.kind}\t{m.value}")


def main():
    ap = argparse.ArgumentParser()
    ap.add_argument("target", help="File or directory to scan")
    args = ap.parse_args()
    p = Path(args.target)
    if p.is_dir():
        for q in p.rglob("*.txt"):
            scan_file(q)
    else:
        scan_file(p)


if __name__ == "__main__":
    main()




