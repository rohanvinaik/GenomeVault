from fastapi.testclient import TestClient

from genomevault.api.app import app

client = TestClient(app)


def test_health():
    r = client.get("/health")
    assert r.status_code == 200 and r.json().get("status") == "healthy"


def test_vectors_encode_roundtrip():
    payload = {"data": [[0, 1, 2, 3]], "dimension": 256}
    r = client.post("/vectors/encode", json=payload)
    assert r.status_code in (200, 422)  # allow validation gate if strict





