{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://genomevault.org/schemas/pir_response.json",
  "title": "PIR Response Schema",
  "description": "Schema for Information-Theoretic PIR response messages",
  "type": "object",
  "required": [
    "query_id",
    "server_id",
    "response_data",
    "computation_time_ms",
    "timestamp"
  ],
  "properties": {
    "query_id": {
      "type": "string",
      "description": "Identifier matching the original query",
      "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
    },
    "server_id": {
      "type": "string",
      "description": "Identifier of the responding server",
      "minLength": 1,
      "maxLength": 64
    },
    "response_data": {
      "type": "string",
      "description": "Base64-encoded XOR result (fixed size: 1024 bytes)",
      "contentEncoding": "base64",
      "minLength": 1366,
      "maxLength": 1366
    },
    "computation_time_ms": {
      "type": "number",
      "description": "Server computation time in milliseconds",
      "minimum": 0
    },
    "timestamp": {
      "type": "number",
      "description": "Unix timestamp of response generation"
    },
    "server_type": {
      "type": "string",
      "description": "Type of server (TS for Trusted Signatory, LN for Light Node)",
      "enum": ["TS", "LN"]
    },
    "signature": {
      "type": "string",
      "description": "Optional cryptographic signature for response integrity",
      "contentEncoding": "base64"
    },
    "error": {
      "type": "object",
      "description": "Error information if query failed",
      "properties": {
        "code": {
          "type": "string"
        },
        "message": {
          "type": "string"
        }
      }
    }
  },
  "additionalProperties": false
}
